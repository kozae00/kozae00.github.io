
>- 도커에서 `docker run` 명령어로 컨테이너를 실행하면 기본적으로 내부에서 작동하는 **주 프로세스**가 있다.
>- 하나의 컨테이너에는 무조건 **1개의 주 프로세스**가 있어야 한다.
>- 물론 **주 프로세스** 말고도 컨테이너 안에는 다른 프로세스들이 있을 수 있다.
>- 주 프로세스를 실행하는 명령어를 **최종 실행 명령어** 라고 한다.
>- 최종실행 명령어는 **엔트리포인트 + 명령어**로 이루어진다.
>- 컨테이너는 내부에서 실행된 **주 프로세스**가 종료되면 **자동으로 종료**된다.

### ✅ 개념 정리

**✔️ 컨테이너 내부에서 실행되는 주 프로세스가 중요**

- 도커에서 컨테이너를 실행할 때 가장 중요한 개념은 **"컨테이너 내부에서 실행되는 주 프로세스"** 이다.
- 컨테이너 내부에서 실행할 때 프로세스가 존재해야 하고, 그것이 실행되는 동안 컨테이너는 유지된다.


**✔️ `hello-world` 컨테이너 실행 과정**

- `docker run hello-world` 를 실행하면, 내부에서 `hello` 라는 프로그램이 실행된다.
- 이 프로세스는 단순히 **"Hello from Docker!"** 메시지를 출력한 후 **즉시 중료**된다.
- 주 프로세스가 종료되었기 때문에 **컨테이너도 즉시 종료**된다.


**✔️ 컨테이너 실행과 종료의 관계**

| 실행 명령어                   | 내부에서 실행되는 최종 실행 명령어     | 실행 후 동작                                                  |
|------------------------------|----------------------------------------|---------------------------------------------------------------|
| `docker run hello-world`     | `/hello` 프로그램 실행                 | 메시지 출력 후 종료                                           |
| `docker run ubuntu`          | `/bin/bash` 실행됨 (일반적으로 종료됨) | `-it` 옵션이 없기 때문에 컨테이너가 실행되었다가 바로 종료됨 |
| `docker run -it ubuntu bash` | `/bin/bash` 실행 (터미널 유지됨)        | 사용자가 종료(`exit`)하기 전까지 컨테이너가 유지됨           |


**✔️ 컨테이너가 종료되는 이유**

- 내부 프로세스가 **종료되었기 떄문**이다.
- 도커 컨테이너는 내부에서 실행된 프로세스가 종료되면 컨테이너도 자동으로 정지됨.
- 컨테이너가 지속되어야 한다면 **오래 지속되는 혹은 영원히 지속되는 프로세스**를 사용해야한다.


**✔️ 예제: `nginx` 컨테이너 종료되지 않는다.**

```sh
docker run nginx
```

- `nginx 웹서버`는 사용자가 명시적으로 종료하지 않으면 계속 실행되기 때문에
- `nginx` 컨테이너는 자동으로 종료되지 않는다.
- `Ctrl + c`로 주 프로세스 종료 ➡️ 컨테이너 종료

---
### ✅ 정리
- OS 에서는 특정 프로세스가 종료되어도 OS가 종료되지 않는다.
    
- 도커 컨테이너는 내부에서 실행되는 **주 프로스세가 종료되면 컨테이너도 종료**된다.
    
- `docker run hello-world` → 실행 후 메시지를 출력하고 즉시 종료됨.
    
- `docker run ubuntu` → `ubuntu` 컨테이너가 실행되지만, `-it` 옵션이 없기 때문에 즉시 종료됨.
    
- `docker run nginx` → `nginx` 서버는 자동으로 종료되지 않는 프로세스이기 때문에 컨테이너가 유지됨.
	     
    - `Ctrl + c` (으)로 주 프로세스 종료 => 컨테이너 종료
    
- 실행을 유지하려면 **오래 지속되는 혹은 영원히 지속되는 프로세스**가 **주 프로세스**가 되도록 해야한다.
